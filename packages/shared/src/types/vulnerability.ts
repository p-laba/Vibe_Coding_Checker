import type { Severity } from "../constants/severity";
import type { PackageEcosystem } from "../constants/scanner";

/**
 * Vulnerability finding (from Trivy SCA)
 */
export interface VulnerabilityFinding {
  /** Finding type discriminator */
  type: "vulnerability";
  /** Unique finding ID */
  id: string;
  /** CVE identifier (e.g., CVE-2024-1234) */
  cveId: string;
  /** Severity level */
  severity: Severity;
  /** Vulnerability title */
  title: string;
  /** Detailed description */
  description: string;
  /** Affected package information */
  package: {
    /** Package name */
    name: string;
    /** Installed version */
    version: string;
    /** Package ecosystem */
    ecosystem: PackageEcosystem;
    /** File where dependency is declared */
    manifestFile?: string;
  };
  /** Fixed version if available */
  fixedVersion?: string;
  /** CVSS score information */
  cvss?: {
    /** CVSS v3 score (0-10) */
    score: number;
    /** CVSS vector string */
    vector?: string;
    /** CVSS version */
    version?: string;
  };
  /** Reference URLs */
  references: string[];
  /** CWE identifiers */
  cweIds?: string[];
  /** Vulnerability publish date */
  publishedAt?: string;
  /** Last modified date */
  modifiedAt?: string;
  /** Whether exploit is known */
  exploitAvailable?: boolean;
  /** EPSS score (Exploit Prediction Scoring System) */
  epssScore?: number;
}

/**
 * Dependency information
 */
export interface Dependency {
  /** Package name */
  name: string;
  /** Installed version */
  version: string;
  /** Package ecosystem */
  ecosystem: PackageEcosystem;
  /** Is direct dependency (vs transitive) */
  isDirect: boolean;
  /** Manifest file path */
  manifestFile: string;
  /** License (if detected) */
  license?: string;
  /** Number of vulnerabilities */
  vulnerabilityCount: number;
}
